<div class="blog-page">
    <div class="container">
        <!-- Blog Header -->
        <div class="blog-header">
            <h1>{{ blog_config.title | default: 'Blog' }}</h1>
            {% if blog_config.description %}
            <p class="blog-description">{{ blog_config.description }}</p>
            {% endif %}
        </div>
        
        <!-- Blog Navigation -->
        <nav class="blog-nav">
            <a href="{{ 'blog' | section_url: current_language }}" class="nav-link active">{{ 'All Posts' | t: current_language }}</a>
            
            {% if blog_categories.size > 0 %}
            <div class="categories-dropdown">
                <button class="dropdown-toggle">{{ 'Categories' | t: current_language }}</button>
                <div class="dropdown-menu">
                    {% for category in blog_categories %}
                    <a href="{{ '/blog/category/' | append: category.slug | url: current_language }}"
                       class="dropdown-item">
                        {{ category.name }} ({{ category.count }})
                    </a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            {% if blog_config.show_archive %}
            <a href="{{ '/blog/archive' | url: current_language }}" class="nav-link">{{ 'Archive' | t: current_language }}</a>
            {% endif %}
            
            {% if blog_config.show_rss %}
            <a href="{{ '/blog/rss.xml' | url: current_language }}" class="nav-link rss-link" target="_blank">
                <i class="icon-rss"></i> RSS
            </a>
            {% endif %}
        </nav>
        
        <!-- Blog Posts -->
        {% if posts.size > 0 %}
        <div class="blog-posts">
            {% for post in posts %}
            <article class="blog-post-card">
                {% if post.image %}
                <div class="post-image">
                    <a href="{{ post.url | url: current_language }}">
                        <img src="{{ post.image | img_url: 'medium' }}" alt="{{ post.title }}" loading="lazy">
                    </a>
                    {% if post.featured %}
                    <span class="badge featured">{{ 'Featured' | t: current_language }}</span>
                    {% endif %}
                </div>
                {% endif %}
                
                <div class="post-content">
                    <div class="post-meta">
                        <time datetime="{{ post.date | date: '%Y-%m-%d' }}">
                            {{ post.date | date: '%B %d, %Y' }}
                        </time>
                        <span class="meta-separator">•</span>
                        <span class="post-author">{{ post.author }}</span>
                        {% if post.category %}
                        <span class="meta-separator">•</span>
                        <a href="{{ '/blog/category/' | append: post.category | url: current_language }}"
                           class="post-category">{{ post.category | replace: '-', ' ' | capitalize }}</a>
                        {% endif %}
                    </div>
                    
                    <h2 class="post-title">
                        <a href="{{ post.url | url: current_language }}">{{ post.title }}</a>
                    </h2>
                    
                    <p class="post-excerpt">{{ post.excerpt }}</p>
                    
                    {% if post.tags.size > 0 %}
                    <div class="post-tags">
                        {% for tag in post.tags %}
                        <span class="tag">#{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                    
                    <div class="post-actions">
                        <a href="{{ post.url | url: current_language }}" class="btn btn-outline">
                            {{ 'Read More' | t: current_language }}
                        </a>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if pagination %}
        {% include 'components/pagination', pagination: pagination %}
        {% endif %}
        
        {% else %}
        <div class="no-posts">
            <p>{{ 'No blog posts found.' | t: current_language }}</p>
            <a href="{{ '/' | url: current_language }}" class="btn btn-primary">
                {{ 'Back to Homepage' | t: current_language }}
            </a>
        </div>
        {% endif %}
        
        <!-- Sidebar -->
        <aside class="blog-sidebar">
            <!-- Recent Posts -->
            {% if all_posts.size > posts.size %}
            <div class="sidebar-widget">
                <h3>{{ 'Recent Posts' | t: current_language }}</h3>
                <ul class="recent-posts">
                    {% for post in all_posts limit: 5 %}
                    {% unless posts contains post %}
                    <li>
                        <a href="{{ post.url | url: current_language }}">
                            {{ post.title }}
                            <small>{{ post.date | date: '%b %d' }}</small>
                        </a>
                    </li>
                    {% endunless %}
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            <!-- Categories -->
            {% if blog_categories.size > 0 %}
            <div class="sidebar-widget">
                <h3>{{ 'Categories' | t: current_language }}</h3>
                <ul class="category-list">
                    {% for category in blog_categories %}
                    <li>
                        <a href="{{ '/blog/category/' | append: category.slug | url: current_language }}">
                            {{ category.name }} <span class="count">({{ category.count }})</span>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            <!-- Archive -->
            {% if blog_config.show_archive and blog_archive.size > 0 %}
            <div class="sidebar-widget">
                <h3>{{ 'Archive' | t: current_language }}</h3>
                <ul class="archive-list">
                    {% for year_data in blog_archive limit: 3 %}
                    <li class="year-item">
                        <strong>{{ year_data.year }}</strong>
                        <ul class="month-list">
                            {% for month_data in year_data.months limit: 6 %}
                            <li>
                                <a href="{{ '/blog/archive/' | append: year_data.year | append: '/' | append: month_data.month | url: current_language }}">
                                    {{ month_data.monthName }} <span class="count">({{ month_data.posts.size }})</span>
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </aside>
    </div>
</div>