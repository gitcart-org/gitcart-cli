---
layout: default
---

<div class="cart-page">
  <h1>Nákupní košík</h1>
  
  <!-- Cart Items Container -->
  <div id="cart-items" class="cart-items">
    <!-- Items will be loaded by JavaScript -->
  </div>
  
  <!-- Empty Cart Message -->
  <div id="empty-cart" class="empty-cart" style="display: none; text-align: center; padding: 60px 20px;">
    <h2>Košík je prázdný</h2>
    <p>Nemáte v košíku žádné produkty.</p>
    <a href="/" style="display: inline-block; background: #0066cc; color: white; padding: 12px 30px; border-radius: 25px; text-decoration: none; margin-top: 20px;">
      Pokračovat v nákupu
    </a>
  </div>
  
  <!-- Cart Summary -->
  <div id="cart-summary" class="cart-summary" style="display: none;">
    <div style="border: 1px solid #eee; border-radius: 8px; padding: 20px; background: #f8f9fa; margin-top: 30px;">
      <h3>Souhrn objednávky</h3>
      
      <div class="summary-line" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
        <span>Mezisoučet:</span>
        <span id="cart-subtotal">0 Kč</span>
      </div>
      
      <div class="summary-line" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
        <span>Doprava:</span>
        <span id="cart-shipping">149 Kč</span>
      </div>
      
      <hr style="margin: 15px 0;">
      
      <div class="summary-line" style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2rem;">
        <span>Celkem:</span>
        <span id="cart-total">0 Kč</span>
      </div>
      
      <button onclick="proceedToCheckout()" 
              style="width: 100%; padding: 15px; font-size: 1.1rem; background: #27ae60; color: white; border: none; border-radius: 6px; margin-top: 20px; cursor: pointer;">
        Pokračovat k objednávce
      </button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  if (typeof GitCart !== 'undefined') {
    loadCartItems();
    
    // Listen for cart updates
    GitCart.on('gitcart:cart:updated', loadCartItems);
  }
});

function loadCartItems() {
  if (typeof GitCart === 'undefined') return;
  
  const items = GitCart.cart.getItems();
  const cartItemsContainer = document.getElementById('cart-items');
  const emptyCartDiv = document.getElementById('empty-cart');
  const cartSummaryDiv = document.getElementById('cart-summary');
  
  if (items.length === 0) {
    cartItemsContainer.innerHTML = '';
    emptyCartDiv.style.display = 'block';
    cartSummaryDiv.style.display = 'none';
    return;
  }
  
  emptyCartDiv.style.display = 'none';
  cartSummaryDiv.style.display = 'block';
  
  // Render cart items
  cartItemsContainer.innerHTML = items.map(item => `
    <div class="cart-item" style="display: flex; gap: 15px; padding: 20px; border-bottom: 1px solid #eee;">
      <div class="item-image" style="flex: 0 0 80px;">
        ${item.image ? 
          `<img src="${item.image}" alt="${item.title}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 4px;">` : 
          `<div style="width: 80px; height: 80px; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">Bez obrázku</div>`
        }
      </div>
      
      <div class="item-info" style="flex: 1;">
        <h3 style="margin: 0 0 5px 0; font-size: 1rem;">
          ${item.url ? `<a href="${item.url}" style="color: inherit; text-decoration: none;">${item.title}</a>` : item.title}
        </h3>
        
        ${item.sku ? `<p style="font-size: 12px; color: #666; margin: 0 0 8px 0;">SKU: ${item.sku}</p>` : ''}
        ${item.variant ? `<p style="font-size: 12px; color: #666; margin: 0 0 8px 0;">Varianta: ${item.variant}</p>` : ''}
        
        <div class="item-price" style="font-weight: bold; color: #0066cc; margin-bottom: 10px;">
          ${formatPrice(item.price)} × ${item.quantity} = ${formatPrice(item.subtotal)}
        </div>
        
        <div class="item-actions" style="display: flex; gap: 10px; align-items: center;">
          <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
            Množství:
            <input type="number" 
                   value="${item.quantity}" 
                   min="1" 
                   max="99"
                   onchange="updateQuantity('${item.sku}', this.value, '${item.variant || ''}')"
                   style="width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
          </label>
          
          <button onclick="removeItem('${item.sku}', '${item.variant || ''}')" 
                  style="padding: 5px 10px; background: #e74c3c; color: white; border: none; border-radius: 3px; font-size: 12px; cursor: pointer;">
            Odebrat
          </button>
        </div>
      </div>
    </div>
  `).join('');
  
  // Update summary
  updateCartSummary();
}

function updateQuantity(sku, quantity, variant) {
  if (typeof GitCart === 'undefined') return;
  
  const newQuantity = parseInt(quantity);
  if (newQuantity < 1) return;
  
  GitCart.cart.updateQuantity(sku, newQuantity, variant || undefined);
}

function removeItem(sku, variant) {
  if (typeof GitCart === 'undefined') return;
  
  if (confirm('Opravdu chcete odebrat tento produkt z košíku?')) {
    GitCart.cart.remove(sku, variant || undefined);
  }
}

function updateCartSummary() {
  if (typeof GitCart === 'undefined') return;
  
  const subtotal = GitCart.cart.getSubtotal();
  const shipping = subtotal >= 1000 ? 0 : 149; // Free shipping over 1000
  const total = subtotal + shipping;
  
  document.getElementById('cart-subtotal').textContent = formatPrice(subtotal);
  document.getElementById('cart-shipping').textContent = shipping === 0 ? 'Zdarma' : formatPrice(shipping);
  document.getElementById('cart-total').textContent = formatPrice(total);
}

function formatPrice(amount) {
  return new Intl.NumberFormat('cs-CZ', {
    style: 'decimal',
    minimumFractionDigits: 0,
    maximumFractionDigits: 0
  }).format(amount) + ' Kč';
}

function proceedToCheckout() {
  // Simple checkout - just redirect to contact or show alert
  alert('Checkout funkcionalita by byla implementována podle vašich potřeb (platební brána, formulář, atd.)');
  
  // Example: redirect to contact page
  // window.location.href = '/contact/?checkout=true';
  
  // Or start GitCart checkout if implemented
  // if (typeof GitCart !== 'undefined' && GitCart.checkout) {
  //   GitCart.checkout.start();
  // }
}
</script>

<!-- Mobile Styles -->
<style>
@media (max-width: 768px) {
  .cart-item {
    flex-direction: column !important;
    gap: 10px !important;
  }
  
  .item-image {
    flex: none !important;
    align-self: center;
  }
  
  .item-actions {
    justify-content: center !important;
  }
}
</style>